<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Individual Digital Readiness (IDR) Test</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #1A1A1A;
            --container-dark: #2A2A2A;
            --container-dark-secondary: #242424; /* Slightly darker for contrast */
            
            --accent-green: #A3E635; /* Lime Green */
            --accent-green-darker: #82B82A;

            --text-light-primary: #F8F9FA;
            --text-light-secondary: #adb5bd;

            --glow-color: rgba(163, 230, 53, 0.2);
            --slider-track-color: #495057;
            --border-color: #495057;

            /* Spektrum Warna Skor (Kuning Rendah, Hijau Tinggi) */
            --color-score-1: #FDE047; /* Yellow */
            --color-score-2: #D9F99D;
            --color-score-3: #A3E635; /* Main Accent Green */
            --color-score-4: #84CC16;
            --color-score-5: #65A30D;
            --color-score-6: #4D7C0F;
            --color-score-7: #365314; /* Deep Green */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-light-secondary);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem 1rem;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
            overflow-x: hidden;
        }

        .logo-container {
            position: fixed;
            top: 2rem;
            left: 2rem;
            z-index: 100;
        }

        .logo-container img {
            height: 40px; /* Atur tinggi logo Anda di sini */
            width: auto;
        }

        .background-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }

        @keyframes move {
            0% {
                transform: translate(0, 0) scale(1);
            }
            50% {
                transform: translate(50px, -80px) scale(1.2);
            }
            100% {
                transform: translate(0, 0) scale(1);
            }
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);
            opacity: 0.1;
            filter: blur(80px);
            animation: move 30s infinite alternate;
        }

        .blob-1 {
            width: 600px;
            height: 600px;
            top: -250px;
            right: -250px;
            animation-duration: 40s;
        }

        .blob-2 {
            width: 500px;
            height: 500px;
            bottom: -200px;
            left: -200px;
            animation-duration: 35s;
            animation-delay: -15s;
        }
        
        .blob-3 {
            width: 400px;
            height: 400px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-duration: 25s;
        }

        .app-container {
            width: 100%;
            max-width: 900px;
        }

        .page {
            display: none;
            flex-direction: column;
            gap: 2rem;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background-color: var(--container-dark);
            color: var(--text-light-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 2.5rem;
        }

        #welcome-card {
            padding: 0;
            overflow: hidden;
        }

        .welcome-split-layout {
            display: flex;
        }

        .welcome-left, .welcome-right {
            flex: 1;
            padding: 3rem;
        }

        .welcome-left {
            background-color: var(--container-dark-secondary);
            text-align: left;
        }

        .welcome-right {
            display: flex;
            flex-direction: column;
        }
        
        .button-container {
            margin-top: 2.5rem; /* Adjusted margin for spacing */
            text-align: center;
        }

        @media (max-width: 800px) {
            .welcome-split-layout {
                flex-direction: column;
            }
            .logo-container {
                top: 1rem;
                left: 1rem;
            }
        }

        h1, h2, h3 {
            color: var(--text-light-primary);
            margin-bottom: 0.5rem;
        }

        #welcome-page h1 {
            font-size: 2.2rem;
            line-height: 1.2;
            margin-bottom: 1rem;
            color: var(--text-light-primary);
            text-align: left;
        }

        h2 {
            font-size: 1.8rem;
        }
        
        h3 {
             font-size: 1.2rem;
        }

        #welcome-page p {
            font-size: 1.05rem;
            max-width: 45ch;
            color: var(--text-light-secondary);
            text-align: left;
            margin-left: 0;
            margin-right: 0;
        }

        p {
            color: var(--text-light-secondary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-light-secondary);
            text-align: left;
        }

        .form-group input[type="text"],
        .form-group input[type="number"] {
            width: 100%;
            padding: 0.8rem 1rem;
            background-color: var(--bg-body);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-light-primary);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        ::placeholder {
            color: var(--text-light-secondary);
            opacity: 0.7;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px var(--glow-color);
        }
        
        .gender-options {
            display: flex;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .gender-options input[type="radio"] {
            display: none; /* Sembunyikan radio button asli */
        }

        .gender-options label {
            flex: 1;
            text-align: center;
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            background-color: transparent;
            color: var(--text-light-secondary);
        }
        
        .gender-options label:first-of-type {
            border-right: 1px solid var(--border-color);
        }
        
        .gender-options input[type="radio"]:checked + label {
            background-color: var(--accent-green);
            color: var(--bg-body);
            font-weight: bold;
        }

        .btn {
            display: inline-block;
            padding: 0.8rem 1.8rem;
            background-color: var(--accent-green);
            border: 1px solid var(--accent-green);
            color: var(--bg-body);
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s, box-shadow 0.3s;
            text-align: center;
            width: 100%;
        }

        .btn-outline {
            background-color: transparent;
            color: var(--accent-green);
            margin-top: 1rem;
        }

        .btn-outline:hover {
            background-color: var(--glow-color);
            color: var(--accent-green);
        }

        .btn:hover, .btn:focus {
            background-color: var(--accent-green-darker);
            border-color: var(--accent-green-darker);
            box-shadow: 0 0 15px var(--glow-color);
        }
        
        .btn:disabled {
            background-color: var(--slider-track-color);
            border-color: var(--slider-track-color);
            color: var(--text-light-secondary);
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Questionnaire Page */
        #instruction-header {
            position: sticky;
            top: 1.5rem;
            z-index: 10;
            margin-bottom: 2rem;
            background-color: var(--container-dark-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            border-left: 4px solid var(--accent-green);
            padding: 1.5rem;
            padding-bottom: 0;
            text-align: left;
            overflow: hidden;
        }

        #instruction-text-container p {
            margin: 0;
            padding-bottom: 0.75rem;
            line-height: 1.7;
            color: var(--text-light-secondary);
            font-size: 1rem;
            letter-spacing: 0.2px;
        }

        #instruction-text-container p:last-child {
            padding-bottom: 1.5rem;
        }

        #instruction-text-container strong {
            color: var(--text-light-primary);
            font-weight: 600;
        }

        #progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: var(--slider-track-color);
        }

        #progress-bar-fill {
            width: 0%;
            height: 100%;
            background-color: var(--accent-green);
            transition: width 0.3s ease-out;
        }
        
        #progress-text {
           display: none;
        }

        #questionnaire-layout {
            display: block;
        }

        .question-card {
            margin-bottom: 2rem;
            padding: 2rem;
            border-left: 4px solid transparent;
            transition: border-left-color 0.3s;
            background-color: var(--container-dark);
        }
        
        .question-card.answered-card {
            border-left-color: var(--accent-green);
        }
        
        .question-text {
            font-size: 1.1rem;
            color: var(--text-light-primary);
            margin-bottom: 2rem;
        }

        /* Slider (Type A) */
        .slider-container {
            position: relative;
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-light-secondary);
            padding: 0 5px;
            margin-top: 0.5rem;
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: var(--slider-track-color);
            border-radius: 5px;
            outline: none;
            margin: 1rem 0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--thumb-color, var(--accent-green));
            cursor: pointer;
            border-radius: 50%;
            transition: box-shadow 0.2s;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--thumb-color, var(--accent-green));
            cursor: pointer;
            border-radius: 50%;
            border: none;
            transition: box-shadow 0.2s;
        }
        
        input[type="range"]:active::-webkit-slider-thumb,
        input[type="range"]:focus::-webkit-slider-thumb {
             box-shadow: 0 0 0 5px var(--glow-color);
        }
        input[type="range"]:active::-moz-range-thumb,
        input[type="range"]:focus::-moz-range-thumb {
             box-shadow: 0 0 0 5px var(--glow-color);
        }

        .slider-value-popup {
            position: absolute;
            top: -35px;
            transform: translateX(-50%);
            background-color: var(--accent-green);
            color: var(--bg-body);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }

        /* Choice (Type B) */
        .choice-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        @media (min-width: 600px) {
            .choice-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .choice-btn {
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .choice-btn:hover {
            border-color: var(--accent-green);
            background-color: rgba(163, 230, 53, 0.05);
        }
        
        .choice-btn.selected {
            border-color: var(--accent-green);
            background-color: var(--glow-color);
            box-shadow: 0 0 10px var(--glow-color);
        }
        
        .choice-btn span {
            font-weight: bold;
            color: var(--accent-green);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        #question-navigation-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        #finish-btn {
            display: none; /* Sembunyikan secara default */
        }

        /* Results Page */
        #global-score-card {
            text-align: center;
            padding: 2rem;
        }
        
        #global-score-card h2 {
            margin-bottom: 1.5rem;
        }
        
        #global-score-interpretation {
            font-size: 1.5rem;
            margin-top: 1.5rem;
            font-weight: 500;
        }
        
        .element-card {
            margin-bottom: 2rem;
        }

        .element-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .element-info {
            text-align: left;
        }

        .element-summary h3 {
            font-size: 1.5rem;
            margin: 0;
        }

        .element-interpretation {
            font-size: 1rem;
            margin: 0.5rem 0 0 0;
            color: var(--text-light-secondary);
            font-weight: 500;
        }

        .element-dimensions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .dimension-card {
            background-color: var(--container-dark-secondary);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            border: 1px solid var(--border-color);
        }
        
        .dimension-card h4 {
            font-size: 1rem;
            min-height: 2.5em; /* Ensure consistent height for titles */
            color: var(--text-light-secondary);
            font-weight: 500;
        }
        
        @keyframes animate-circle {
            to {
                stroke-dashoffset: var(--target-offset);
            }
        }

        .progress-circle {
            position: relative;
            margin: 1rem 0;
        }
        
        .global-circle {
            width: 200px;
            height: 200px;
            margin: 1.5rem auto;
        }
        
        .element-circle {
            width: 120px;
            height: 120px;
        }

        .dimension-circle {
             width: 100px;
            height: 100px;
        }
        
        .progress-circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-circle circle {
            fill: none;
        }
        
        .progress-circle .bg-circle {
            stroke: var(--slider-track-color);
        }
        
        .progress-circle .fg-circle {
            stroke: var(--color);
            stroke-linecap: round;
        }
        
        .progress-circle.animated .fg-circle {
             animation: animate-circle 1.5s ease-out forwards;
        }

        .global-circle circle { stroke-width: 10; }
        .global-circle .fg-circle { stroke-dasharray: 283; stroke-dashoffset: 283; }

        .element-circle circle { stroke-width: 8; }
        .element-circle .fg-circle { stroke-dasharray: 251.2; stroke-dashoffset: 251.2; }
        
        .dimension-circle circle { stroke-width: 8; }
        .dimension-circle .fg-circle { stroke-dasharray: 188.4; stroke-dashoffset: 188.4; }


        .progress-circle-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: 600;
            color: var(--text-light-primary);
        }
        
        .global-circle .progress-circle-value { font-size: 3.5rem; }
        .element-circle .progress-circle-value { font-size: 2rem; }
        .dimension-circle .progress-circle-value { font-size: 1.8rem; }
        
        #restart-btn {
            background-color: transparent;
            color: var(--accent-green);
            border-color: var(--accent-green);
        }
        
         #restart-btn:hover {
            background-color: var(--glow-color);
            color: var(--accent-green);
        }
    </style>
</head>
<body>
    <div class="logo-container">
        <!-- Ganti URL di bawah ini dengan link ke file logo Anda -->
        <img src="https://placehold.co/120x50/1A1A1A/A3E635?text=LOGO" alt="Logo Perusahaan">
    </div>

    <div class="background-glow">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="app-container">
        <!-- Halaman 1: Selamat Datang -->
        <div id="welcome-page" class="page active">
            <form id="user-info-form">
                <div class="card" id="welcome-card">
                    <div class="welcome-split-layout">
                        <div class="welcome-left">
                            <h1>Individual Digital Readiness (IDR) Test</h1>
                            <p>Selamat datang! Kuesioner ini bertujuan untuk mengukur kesiapan digital individu berdasarkan model IDR. Mohon isi data diri Anda di bawah ini untuk memulai.</p>
                             <div class="form-group">
                                <label for="name">Nama Lengkap</label>
                                <input type="text" id="name" name="name" required>
                            </div>
                             <div class="form-group">
                                <label for="age">Usia</label>
                                <input type="number" id="age" name="age" min="0" required>
                            </div>
                            <div class="form-group">
                                <label>Jenis Kelamin</label>
                                <div class="gender-options">
                                    <input type="radio" id="gender-male" name="gender" value="Laki-laki" required>
                                    <label for="gender-male">Laki-laki</label>
                                    
                                    <input type="radio" id="gender-female" name="gender" value="Perempuan" required>
                                    <label for="gender-female">Perempuan</label>
                                </div>
                            </div>
                        </div>
                        <div class="welcome-right">
                           <div>
                                <div class="form-group">
                                    <label for="position-level">Level Jabatan</label>
                                    <input type="text" id="position-level" name="position-level" placeholder="Contoh: Staff" required>
                                </div>
                                <div class="form-group">
                                    <label for="job">Pekerjaan</label>
                                    <input type="text" id="job" name="job" placeholder="Contoh: Pemasaran" required>
                                </div>
                                <div class="form-group">
                                    <label for="industry">Industri</label>
                                    <input type="text" id="industry" name="industry" placeholder="Contoh: Teknologi" required>
                                </div>
                           </div>
                           <div class="button-container">
                                <button type="submit" class="btn">Mulai</button>
                                <button type="button" id="prototype-btn" class="btn btn-outline">Isi & Jawab Otomatis (Prototipe)</button>
                           </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Halaman 2: Kuesioner -->
        <div id="questionnaire-page" class="page">
            <div id="instruction-header">
                <div id="instruction-text-container"></div>
                <div id="progress-bar">
                    <div id="progress-bar-fill"></div>
                </div>
            </div>
            <div id="questionnaire-layout">
                <div id="questions-container-wrapper">
                    <div id="questions-container">
                        <!-- Pertanyaan akan di-generate oleh JavaScript di sini -->
                    </div>
                    <div id="question-navigation-container">
                        <button id="prev-btn" class="btn">Sebelumnya</button>
                        <button id="next-btn" class="btn">Selanjutnya</button>
                        <button id="finish-btn" class="btn">Selesai & Lihat Hasil</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Halaman 3: Hasil -->
        <div id="results-page" class="page">
             <div id="global-score-card" class="card">
                <h2>Skor Kesiapan Digital Anda</h2>
                <div class="progress-circle global-circle" data-score="0">
                     <svg viewBox="0 0 100 100">
                        <circle class="bg-circle" cx="50" cy="50" r="45"></circle>
                        <circle class="fg-circle" cx="50" cy="50" r="45"></circle>
                    </svg>
                    <div class="progress-circle-value">0</div>
                </div>
                <p id="global-score-interpretation">Analisis</p>
            </div>
            
            <div id="elements-container">
                <!-- Hasil per elemen dan dimensi akan di-generate di sini -->
            </div>
            
             <div class="card" style="text-align: center;">
                <h2>Terima Kasih</h2>
                <p>Data Anda telah dicatat. Anda dapat menutup halaman ini sekarang.</p>
                <button id="restart-btn" class="btn">Ulangi</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // =================================================================================
            // DATA & KONFIGURASI
            // =================================================================================
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwR_sC5eG8YtFw2LqZ3sXv8JkKjN7pDqA9hXcVbN0rL5iYtUoI6E7Wp/exec';

             const questions = [
                // Digital Perspective (A1)
                { id: "A11_1", element: "A1", dimension: "A11", type: "A", text: "Saya percaya bahwa teknologi digital adalah penunjang utama pekerjaan saya saat ini" },
                { id: "A11_2", element: "A1", dimension: "A11", type: "A", text: "Saya percaya penggunaan teknologi digital dapat mengoptimalkan kinerja" },
                { id: "A11_3", element: "A1", dimension: "A11", type: "A", text: "Saya mampu mengenali teknologi digital mana yang dapat menunjang kinerja" },
                { id: "A11_4", element: "A1", dimension: "A11", type: "A", text: "Saya bersedia membantu rekan kerja agar lebih familiar dengan teknologi digital yang baru diterapkan" },
                { id: "A12_1", element: "A1", dimension: "A12", type: "A", text: "Saya tertarik mengikuti perkembangan teknologi digital yang berkaitan dengan pekerjaan" },
                { id: "A12_2", element: "A1", dimension: "A12", type: "A", text: "Saya mendukung perubahan proses kerja ke arah yang lebih modern dan digital" },
                { id: "A12_3", element: "A1", dimension: "A12", type: "A", text: "Saya meyakini bahwa adopsi teknologi digital dapat mempercepat pertumbuhan karier saya" },
                { id: "A12_4", element: "A1", dimension: "A12", type: "A", text: "Saya tertarik mencoba teknologi digital baru yang enggan digunakan oleh rekan kerja" },
                { id: "A13_1", element: "A1", dimension: "A13", type: "A", text: "Saya yakin bahwa setiap orang dapat menguasai teknologi digital jika sungguh-sungguh mempelajari" },
                { id: "A13_2", element: "A1", dimension: "A13", type: "A", text: "Saya bersedia meluangkan waktu untuk mempelajari teknologi digital" },
                { id: "A13_3", element: "A1", dimension: "A13", type: "A", text: "Saya senang mengeksplorasi fitur-fitur teknologi digital baru di luar bidang saya" },
                { id: "A13_4", element: "A1", dimension: "A13", type: "A", text: "Saya memiliki perencanaan jangka panjang untuk meningkatkan keterampilan digital" },
                // Digital Tasking Competency (A2)
                { id: "A21_1", element: "A2", dimension: "A21", type: "A", text: "Saya mudah memahami dan mengoperasikan teknologi yang baru diperkenalkan" },
                { id: "A21_2", element: "A2", dimension: "A21", type: "A", text: "Saya cepat menyelaraskan alur kerja agar sesuai dengan sistem teknologi baru" },
                { id: "A21_3", element: "A2", dimension: "A21", type: "A", text: "Saya mampu memulihkan proses kerja dengan cepat saat terganggu oleh perubahan digital" },
                { id: "A22_1", element: "A2", dimension: "A22", type: "A", text: "Saya mampu menggunakan berbagai fitur teknologi digital untuk menyelesaikan pekerjaan" },
                { id: "A22_2", element: "A2", dimension: "A22", type: "A", text: "Saya jarang melakukan kesalahan saat menggunakan teknologi digital untuk bekerja" },
                { id: "A22_3", element: "A2", dimension: "A22", type: "A", text: "Saya mampu memanfaatkan teknologi digital untuk menghasilkan pekerjaan yang berkualitas" },
                { id: "A23_1", element: "A2", dimension: "A23", type: "A", text: "Saya mampu menemukan solusi saat menghadapi masalah teknis terkait penggunaan teknologi digital" },
                { id: "A23_2", element: "A2", dimension: "A23", type: "A", text: "Saya mampu beradaptasi dengan cepat ketika terjadi perubahan teknologi digital" },
                { id: "A23_3", element: "A2", dimension: "A23", type: "A", text: "Saya dapat mengidentifikasi masalah yang disebabkan oleh perubahan sistem digital di tempat kerja" },
                // Digital Responsiveness (A3)
                { id: "A31_1", element: "A3", dimension: "A31", type: "A", text: "Saya mampu membedakan teknologi digital yang hanya akan menjadi tren sesaat dan yang akan berdampak besar pada pekerjaan" },
                { id: "A31_2", element: "A3", dimension: "A31", type: "A", text: "Saya memetakan proses kerja yang dapat dipercepat dengan adanya perkembangan teknologi digital" },
                { id: "A31_3", element: "A3", dimension: "A31", type: "A", text: "Saya mampu memprediksi dampak risiko dari suatu perkembangan teknologi terhadap keberlangsungan bisnis" },
                { id: "A32_1", element: "A3", dimension: "A32", type: "A", text: "Saya mengatur ulang prioritas kerja untuk memberi ruang bagi adaptasi teknologi digital baru" },
                { id: "A32_2", element: "A3", dimension: "A32", type: "A", text: "Saya memusatkan perhatian pada fitur teknologi digital yang paling relevan dengan pekerjaan" },
                { id: "A32_3", element: "A3", dimension: "A32", type: "A", text: "Saya menyesuaikan strategi kerja lama dengan teknologi digital terbaru agar hasil kerja tetap optimal" },
                { id: "A32_4", element: "A3", dimension: "A32", type: "A", text: "Saya mempersiapkan tools digital cadangan untuk mengantisipasi gangguan saat digunakan" },
                { id: "A33_1", element: "A3", dimension: "A33", type: "A", text: "Saya memastikan pekerjaan tetap akurat ketika sistem mengalami penyesuaian sistem digital" },
                { id: "A33_2", element: "A3", dimension: "A33", type: "A", text: "Saya mengatur ulang alur kerja agar tetap efisien saat ada penyesuaian sistem digital" },
                { id: "A33_3", element: "A3", dimension: "A33", type: "A", text: "Saya memanfaatkan fitur teknologi digital yang baru untuk mempercepat proses kerja tanpa menurunkan kualitas" },
                 // GRIT (B1)
                { id: "B11_1", element: "B1", dimension: "B11", type: "A", text: "Ketika target berubah, saya menyesuaikan rencana tanpa meninggalkan tujuan utama" },
                { id: "B11_2", element: "B1", dimension: "B11", type: "A", text: "Proyek yang telah mulai biasanya tetap saya selesaikan meskipun ada hal baru yang lebih menarik" },
                { id: "B11_3", element: "B1", dimension: "B11", type: "A", text: "Saya menjaga kesinambungan tujuan meskipun minat dan prioritas saya berubah" },
                { id: "B11_4", element: "B1", dimension: "B11", type: "A", text: "Saya cenderung menekuni suatu bidang pekerjaan yang sama dalam jangka waktu yang lama" },
                { id: "B12_1", element: "B1", dimension: "B12", type: "A", text: "Saya tetap melanjutkan pekerjaan walau hasilnya tidak sesuai harapan" },
                { id: "B12_2", element: "B1", dimension: "B12", type: "A", text: "Saya menyelesaikan pekerjaan sampai tuntas meski harus menanggung beban ekstra" },
                { id: "B12_3", element: "B1", dimension: "B12", type: "A", text: "Saya mengusahakan hasil terbaik meskipun untuk mendapatkan pekerjaan yang terasa sulit" },
                // Curiosity (B2)
                { id: "B2_1", element: "B2", dimension: "B2", type: "B", textI: "Saya senang mempelajari berbagai teknologi digital baru walau tidak ada yang meminta", textD: "Saya terdorong mengeksplorasi teknologi digital secara lebih dalam ketika merasa ada yang kurang jelas" },
                { id: "B2_2", element: "B2", dimension: "B2", type: "B", textI: "Saya berinisiatif mempelajari dan digital untuk memperluas pengetahuan", textD: "Saya tidak melewatkan info fitur-fitur di teknologi saya bahkan yang paya" },
                { id: "B2_3", element: "B2", dimension: "B2", type: "B", textI: "Saya merasa antusias saat menemukan inovasi digital yang dapat meningkatkan efisiensi kerja", textD: "Sulit berhenti memikirkan masalah teknis akibat gangguan digital sampai menemukan solusinya" },
                { id: "B2_4", element: "B2", dimension: "B2", type: "B", textI: "Saya tertarik mencoba teknologi digital yang belum pernah saya gunakan sebelumnya", textD: "Saya senang mencari tahu menahu suatu teknologi digital sebelum mulai menggunakan" },
                { id: "B2_5", element: "B2", dimension: "B2", type: "B", textI: "Saya termotivasi mempelajari inovasi digital demi memperluas wawasan", textD: "Saya termotivasi mempelajari inovasi digital karena tuntutan pekerjaan" },
                { id: "B2_6", element: "B2", dimension: "B2", type: "B", textI: "Saya suka mencoba fitur-fitur baru pada aplikasi digital untuk menemukan cara kerja yang paling efektif", textD: "Saya mengikuti pelatihan digital untuk menguasai keterampilan yang diperlukan dalam pekerjaan saya" },
                { id: "B2_7", element: "B2", dimension: "B2", type: "B", textI: "Saya mempelajari perkembangan teknologi digital untuk menemukan cara memperbaiki proses kerja", textD: "Saya mempelajari perkembangan teknologi digital untuk memastikan tidak tertinggal" },
                { id: "B2_8", element: "B2", dimension: "B2", type: "B", textI: "Saya sengaja mencoba berbagai fitur teknologi digital di luar fungsi utamanya", textD: "Saya mengeksplorasi teknologi digital untuk memastikan semua fiturnya dapat digunakan" },
                { id: "B2_9", element: "B2", dimension: "B2", type: "B", textI: "Saya senang mengeksplorasi berbagai alat digital untuk menemukan fungsi tambahan", textD: "Saya mengotak-atik berbagai alat digital untuk memastikan programnya fungsinya sesuai kebutuhan" },
                { id: "B2_10", element: "B2", dimension: "B2", type: "B", textI: "Saya mencoba fitur-fitur baru pada aplikasi digital karena meminati pengalamannya", textD: "Saya mempelajari fitur baru pada aplikasi digital sampai saya memahami cara kerjanya secara menyeluruh" },
            ];

            const dimensionDetails = {
                A11: { name: "Perceived Value of Technology", element: "A1" },
                A12: { name: "Openness to Digital Innovation", element: "A1" },
                A13: { name: "Growth-Oriented Digital Mindset", element: "A1" },
                A21: { name: "Speed of Adjustment", element: "A2" },
                A22: { name: "Accuracy of Implementation", element: "A2" },
                A23: { name: "Technological Assimilation", element: "A2" },
                A31: { name: "Digital Sensitivity", element: "A3" },
                A32: { name: "Resource Flexibility", element: "A3" },
                A33: { name: "Maintained Productivity in Change", element: "A3" },
                B11: { name: "Consistency of interest", element: "B1" },
                B12: { name: "Perseverance of effort", element: "B1" },
                B21: { name: "I-Type Curiosity (Interest)", element: "B2" },
                B22: { name: "D-Type Curiosity (Deprivation)", element: "B2" },
            };
            
            const elementDetails = {
                A1: { name: "Digital Perspective" },
                A2: { name: "Digital Tasking Competency" },
                A3: { name: "Digital Responsiveness" },
                B1: { name: "GRIT" },
                B2: { name: "Curiosity" }
            };
            
            // =================================================================================
            // State Aplikasi
            // =================================================================================
            let userData = {};
            let answers = {};
            let currentQuestionPage = 0;

            // KONFIGURASI HALAMAN KUESIONER
            const pagesConfig = [];
            const questionsPerPageA = 4;
            const questionsPerPageB = 5; 

            // Kelompokkan semua soal Tipe A
            const questionsA = questions.filter(q => q.type === 'A');
            for (let i = 0; i < questionsA.length; i += questionsPerPageA) {
                pagesConfig.push(questionsA.slice(i, i + questionsPerPageA));
            }
            
            // Kelompokkan semua soal Tipe B
            const questionsB = questions.filter(q => q.type === 'B');
             for (let i = 0; i < questionsB.length; i += questionsPerPageB) {
                pagesConfig.push(questionsB.slice(i, i + questionsPerPageB));
            }
            
            const totalPages = pagesConfig.length;


            // =================================================================================
            // Referensi DOM
            // =================================================================================
            const pages = {
                welcome: document.getElementById('welcome-page'),
                questionnaire: document.getElementById('questionnaire-page'),
                results: document.getElementById('results-page')
            };
            const userInfoForm = document.getElementById('user-info-form');
            const questionsContainer = document.getElementById('questions-container');
            const progressBarFill = document.getElementById('progress-bar-fill');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const finishBtn = document.getElementById('finish-btn');
            const restartBtn = document.getElementById('restart-btn');
            const prototypeBtn = document.getElementById('prototype-btn');
            const instructionTextContainer = document.getElementById('instruction-text-container');
            const elementsContainer = document.getElementById('elements-container');
            
            // =================================================================================
            // Fungsi Inti
            // =================================================================================

            function showPage(pageName) {
                Object.values(pages).forEach(page => page.classList.remove('active'));
                pages[pageName].classList.add('active');
            }

            function startQuestionnaire(e) {
                e.preventDefault();
                const formData = new FormData(userInfoForm);
                userData = Object.fromEntries(formData.entries());
                
                if (!userData.name || !userData.gender || !userData.age || !userData.job) {
                    alert("Mohon isi semua data diri.");
                    return;
                }
                
                renderQuestions();
                showPage('questionnaire');
                window.scrollTo(0, 0);

                const answeredCount = Object.keys(answers).length;
                if (answeredCount > 0) {
                    const totalQuestions = questions.length;
                    const percentage = (answeredCount / totalQuestions) * 100;
                    progressBarFill.style.width = `${percentage}%`;
                    updateNavButtons();
                }
            }

            function renderQuestions() {
                questionsContainer.innerHTML = '';
                const questionsToRender = pagesConfig[currentQuestionPage];

                const firstQuestionType = questionsToRender[0].type;
                if (firstQuestionType === 'A') {
                    instructionTextContainer.innerHTML = `
                        <p><strong>Bacalah</strong> setiap pernyataan dan <strong>geser slider</strong> yang sesuai untuk menggambarkan diri Anda.</p>
                        <p>Jawablah dengan <strong>jujur</strong> sesuai kondisi yang Anda alami karena tidak ada jawaban <strong>BENAR</strong> maupun <strong>SALAH</strong>.</p>
                    `;
                } else { // Type B
                    instructionTextContainer.innerHTML = `
                        <p><strong>Bacalah</strong> setiap pernyataan dan <strong>pilihlah</strong> yang paling sesuai untuk menggambarkan diri Anda.</p>
                        <p>Jawablah dengan <strong>jujur</strong> sesuai kondisi yang Anda alami karena tidak ada jawaban <strong>BENAR</strong> maupun <strong>SALAH</strong>.</p>
                    `;
                }

                questionsToRender.forEach(q => {
                    const originalIndex = questions.findIndex(origQ => origQ.id === q.id);
                    const questionCard = document.createElement('div');
                    questionCard.className = 'card question-card';
                    questionCard.id = `question-${originalIndex}`;
                    
                    if (answers[q.id]) {
                        questionCard.classList.add('answered-card');
                    
                        if (q.type === 'A') {
                            const color = getColorForSliderValue(parseInt(answers[q.id]));
                            questionCard.style.borderLeftColor = color;
                        } else {
                            questionCard.style.borderLeftColor = 'var(--accent-green)';
                        }
                    }

                    let questionHTML = '';

                    if (q.type === 'A') {
                        const value = answers[q.id] || 1;
                        questionHTML += `
                            <p class="question-text">${q.text}</p>
                            <div class="slider-container">
                                <div class="slider-value-popup">${value}</div>
                                <input type="range" id="q_${q.id}" data-question-id="${q.id}" data-index="${originalIndex}" min="1" max="6" value="${value}" step="1">
                                <div class="slider-labels">
                                    <span>Sangat Tidak Sesuai</span>
                                    <span>Sangat Sesuai</span>
                                </div>
                            </div>`;
                    } else if (q.type === 'B') {
                        const selectedValue = answers[q.id];
                        questionHTML += `
                            <p class="question-text">Pilihlah pernyataan yang paling sesuai dengan diri Anda:</p>
                            <div class="choice-container">
                                <div class="choice-btn ${selectedValue === 'I' ? 'selected' : ''}" data-question-id="${q.id}" data-value="I" data-index="${originalIndex}">
                                    <span>Pilihan I</span>
                                    <p>${q.textI}</p>
                                </div>
                                <div class="choice-btn ${selectedValue === 'D' ? 'selected' : ''}" data-question-id="${q.id}" data-value="D" data-index="${originalIndex}">
                                    <span>Pilihan D</span>
                                    <p>${q.textD}</p>
                                </div>
                            </div>`;
                    }
                    questionCard.innerHTML = questionHTML;
                    questionsContainer.appendChild(questionCard);
                });
                
                addQuestionEventListeners();
                updateNavButtons();
            }


            function addQuestionEventListeners() {
                document.querySelectorAll('input[type="range"]').forEach(slider => {
                    updateSliderAppearance(slider);
                    slider.addEventListener('input', () => updateSliderAppearance(slider));
                    slider.addEventListener('change', (e) => handleAnswer(e.target.dataset.questionId, e.target.value, parseInt(e.target.dataset.index)));
                    slider.addEventListener('mousedown', (e) => e.target.previousElementSibling.style.opacity = '1');
                    slider.addEventListener('touchstart', (e) => e.target.previousElementSibling.style.opacity = '1');
                    slider.addEventListener('mouseup', (e) => e.target.previousElementSibling.style.opacity = '0');
                    slider.addEventListener('touchend', (e) => e.target.previousElementSibling.style.opacity = '0');
                });

                document.querySelectorAll('.choice-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const currentButton = e.currentTarget;
                        const questionId = currentButton.dataset.questionId;
                        const value = currentButton.dataset.value;
                        document.querySelectorAll(`.choice-btn[data-question-id="${questionId}"]`).forEach(btn => btn.classList.remove('selected'));
                        currentButton.classList.add('selected');
                        handleAnswer(questionId, value, parseInt(currentButton.dataset.index));
                    });
                });
            }

            function updateNavButtons() {
                prevBtn.disabled = currentQuestionPage === 0;

                const answeredCount = Object.keys(answers).length;
                if (currentQuestionPage === totalPages - 1) {
                    nextBtn.style.display = 'none';
                    if (answeredCount === questions.length) {
                        finishBtn.style.display = 'inline-block';
                    } else {
                        finishBtn.style.display = 'none';
                    }
                } else {
                    nextBtn.style.display = 'inline-block';
                    finishBtn.style.display = 'none';
                }
            }


            function updateSliderAppearance(slider) {
                const value = slider.value;
                const min = slider.min;
                const max = slider.max;
                const percentage = ((value - min) / (max - min)) * 100;
                
                const colorStops = ['var(--color-score-1)', 'var(--color-score-2)', 'var(--color-score-3)', 'var(--color-score-4)', 'var(--color-score-5)', 'var(--color-score-6)', 'var(--color-score-7)'];
                const colorIndex = Math.min(Math.round((percentage/100) * (colorStops.length - 1)), colorStops.length-1);
                const color = colorStops[colorIndex];
                
                slider.style.background = `linear-gradient(to right, ${color} ${percentage}%, var(--slider-track-color) ${percentage}%)`;
                slider.style.setProperty('--thumb-color', color);

                const popup = slider.previousElementSibling;
                popup.textContent = value;
                const thumbWidth = 24;
                const popupPosition = (percentage / 100) * (slider.offsetWidth - thumbWidth) + (thumbWidth / 2);
                popup.style.left = `${popupPosition}px`;
            }

            function getColorForSliderValue(value) {
                const scoreValue = Math.min(Math.max(value, 1), 6);
                return `var(--color-score-${scoreValue})`;
            }

            function handleAnswer(questionId, value, index) {
                answers[questionId] = value;
                updateProgress();

                const questionCard = document.getElementById(`question-${index}`);
                questionCard.classList.add('answered-card');

                const question = questions[index];
                if (question.type === 'A') {
                    const color = getColorForSliderValue(parseInt(value));
                    questionCard.style.borderLeftColor = color;
                } else {
                    questionCard.style.borderLeftColor = 'var(--accent-green)';
                }

                checkAndAutoNext();
            }

            function checkAndAutoNext() {
                const questionsOnCurrentPage = pagesConfig[currentQuestionPage];
                const allAnsweredOnPage = questionsOnCurrentPage.every(q => answers.hasOwnProperty(q.id));

                if (allAnsweredOnPage && currentQuestionPage < totalPages - 1) {
                    setTimeout(() => {
                        nextBtn.click();
                    }, 500); // Penundaan 500ms untuk UX
                }
            }

            function updateProgress() {
                const answeredCount = Object.keys(answers).length;
                const totalQuestions = questions.length;
                const percentage = (answeredCount / totalQuestions) * 100;
                
                progressBarFill.style.width = `${percentage}%`;
                
                if (answeredCount === totalQuestions) {
                    updateNavButtons();
                }
            }

            function calculateResults() {
                const scores = {};
                
                Object.keys(dimensionDetails).forEach(dimId => {
                    scores[dimId] = { total: 0, count: 0, normalized: 0 };
                });
                
                // Process Type A questions
                questions.filter(q => q.type === 'A').forEach(q => {
                    const answer = answers[q.id];
                    if (answer !== undefined) {
                        scores[q.dimension].total += parseInt(answer);
                        scores[q.dimension].count++;
                    }
                });

                // Process Type B questions (Curiosity)
                const questionsB = questions.filter(q => q.element === 'B2');
                scores['B21'].count = questionsB.length;
                scores['B22'].count = questionsB.length;
                questionsB.forEach(q => {
                    const answer = answers[q.id];
                    if (answer === 'I') {
                        scores['B21'].total++;
                    } else if (answer === 'D') {
                        scores['B22'].total++;
                    }
                });
                
                // Normalize scores
                Object.keys(scores).forEach(dimId => {
                    const dim = scores[dimId];
                    if (dim.count === 0) {
                        dim.normalized = 0;
                        return;
                    }
                    
                    if (dimId.startsWith('A') || dimId.startsWith('B1')) { // Likert scale dimensions
                        const avg = dim.total / dim.count;
                        dim.normalized = ((avg - 1) / (6 - 1)) * 100;
                    } else if (dimId.startsWith('B2')) { // Curiosity dimensions
                        dim.normalized = (dim.total / dim.count) * 100;
                    }
                });

                // Calculate element scores
                const finalElementScores = {};
                Object.keys(elementDetails).forEach(elId => {
                    const dimsOfElement = Object.keys(dimensionDetails).filter(dimId => dimensionDetails[dimId].element === elId);
                    let totalScore = 0;
                    dimsOfElement.forEach(dimId => {
                        totalScore += scores[dimId].normalized;
                    });
                    finalElementScores[elId] = dimsOfElement.length > 0 ? totalScore / dimsOfElement.length : 0;
                });
                
                const globalScore = (finalElementScores.A1 + finalElementScores.A2 + finalElementScores.A3 + finalElementScores.B1 + finalElementScores.B2) / 5;

                return {
                    globalScore: globalScore,
                    dimensionScores: scores,
                    elementScores: finalElementScores
                };
            }

            function getInterpretation(score) {
                if (score < 37.50) return "Rendah";
                if (score <= 50.00) return "Cenderung Rendah";
                if (score <= 78.50) return "Cukup";
                if (score <= 85.00) return "Cenderung Tinggi";
                return "Tinggi";
            }

            function getColorForScore(score) {
                const scoreColors = ['var(--color-score-1)', 'var(--color-score-2)', 'var(--color-score-3)', 'var(--color-score-4)', 'var(--color-score-5)', 'var(--color-score-6)', 'var(--color-score-7)'];
                if (score < 15) return scoreColors[0];
                if (score < 30) return scoreColors[1];
                if (score < 45) return scoreColors[2];
                if (score < 60) return scoreColors[3];
                if (score < 75) return scoreColors[4];
                if (score < 90) return scoreColors[5];
                return scoreColors[6];
            }
            
            function animateValue(obj, start, end, duration) {
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    obj.innerHTML = Math.floor(progress * (end - start) + start);
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }

            function displayResults(results) {
                // Display Global Score
                const globalScoreCard = document.getElementById('global-score-card');
                const globalProgressCircle = globalScoreCard.querySelector('.progress-circle');
                const globalScoreValueEl = globalScoreCard.querySelector('.progress-circle-value');
                const globalScoreInterpretation = globalScoreCard.querySelector('#global-score-interpretation');
                
                const finalGlobalScore = results.globalScore;
                
                globalProgressCircle.dataset.score = finalGlobalScore;
                globalScoreInterpretation.textContent = getInterpretation(finalGlobalScore);

                // Display Elements and their Dimensions
                elementsContainer.innerHTML = '';
                Object.keys(elementDetails).forEach(elId => {
                    const elementCard = document.createElement('div');
                    elementCard.className = 'card element-card';
                    
                    const elementScore = results.elementScores[elId];

                    let dimensionsHTML = '';
                    const dimsOfElement = Object.keys(dimensionDetails).filter(dimId => dimensionDetails[dimId].element === elId);

                    dimsOfElement.forEach(dimId => {
                        const dimData = results.dimensionScores[dimId];
                        if (dimData) {
                            const normalizedScore = dimData.normalized;
                            dimensionsHTML += `
                                <div class="dimension-card">
                                    <h4>${dimensionDetails[dimId].name}</h4>
                                    <div class="progress-circle dimension-circle" data-score="${normalizedScore}">
                                        <svg viewBox="0 0 100 100">
                                            <circle class="bg-circle" cx="50" cy="50" r="45"></circle>
                                            <circle class="fg-circle" cx="50" cy="50" r="45"></circle>
                                        </svg>
                                        <div class="progress-circle-value">0</div>
                                    </div>
                                </div>
                            `;
                        }
                    });

                    elementCard.innerHTML = `
                        <div class="element-summary">
                             <div class="element-info">
                                <h3>${elementDetails[elId].name}</h3>
                                <p class="element-interpretation">${getInterpretation(elementScore)}</p>
                             </div>
                            <div class="progress-circle element-circle" data-score="${elementScore}">
                                <svg viewBox="0 0 100 100">
                                    <circle class="bg-circle" cx="50" cy="50" r="45"></circle>
                                    <circle class="fg-circle" cx="50" cy="50" r="45"></circle>
                                </svg>
                                <div class="progress-circle-value">0</div>
                            </div>
                        </div>
                        <div class="element-dimensions-grid">
                            ${dimensionsHTML}
                        </div>
                    `;
                    elementsContainer.appendChild(elementCard);
                });
                
                showPage('results');
                window.scrollTo(0, 0);

                // Animate circles when they appear
                const circles = document.querySelectorAll('.progress-circle');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const circle = entry.target;
                            const score = circle.dataset.score;
                            
                            let radius = 45; // Default for global and element
                            if (circle.classList.contains('dimension-circle')) {
                                radius = 45; // Same radius for visual consistency inside the SVG
                            }

                            const circumference = 2 * Math.PI * radius;
                            const offset = circumference - (score / 100) * circumference;
                            
                            const fgCircle = circle.querySelector('.fg-circle');
                            
                            fgCircle.style.strokeDasharray = circumference;
                            fgCircle.style.setProperty('--target-offset', offset);
                            fgCircle.style.setProperty('--color', getColorForScore(score));
                            
                            circle.classList.add('animated');

                            const valueEl = circle.querySelector('.progress-circle-value');
                            animateValue(valueEl, 0, Math.round(score), 1500);
                            
                            observer.unobserve(circle);
                        }
                    });
                }, { threshold: 0.1 });

                circles.forEach(circle => observer.observe(circle));
            }

            async function sendDataToSheet(results) {
                const dataToSend = new FormData();
                dataToSend.append('timestamp', new Date().toISOString());
                Object.entries(userData).forEach(([key, value]) => dataToSend.append(key, value));
                Object.entries(answers).forEach(([key, value]) => dataToSend.append(key, value));
                dataToSend.append('global_score', results.globalScore.toFixed(2));
                Object.keys(dimensionDetails).forEach(dimId => {
                    if(results.dimensionScores[dimId]){
                        dataToSend.append(`score_${dimId}`, results.dimensionScores[dimId].normalized.toFixed(2));
                    }
                });

                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: dataToSend,
                    });
                    console.log('Data successfully sent to Google Sheet.');
                } catch (error) {
                    console.error('Error sending data to Google Sheet:', error);
                }
            }
            
            async function submitAndShowResults() {
                if (Object.keys(answers).length < questions.length) {
                    alert("Mohon jawab semua pertanyaan sebelum melihat hasil.");
                    return;
                }

                finishBtn.disabled = true;
                finishBtn.textContent = 'Memproses...';

                const results = calculateResults();
                displayResults(results);
                await sendDataToSheet(results);
            }
            
            function restartTest() {
                userData = {};
                answers = {};
                currentQuestionPage = 0;
                userInfoForm.reset();
                progressBarFill.style.width = '0%';
                finishBtn.style.display = 'none';
                finishBtn.disabled = false;
                finishBtn.textContent = 'Selesai & Lihat Hasil';
                showPage('welcome');
                 window.scrollTo(0, 0);
            }

            function runPrototypeMode() {
                document.getElementById('name').value = 'User Prototipe';
                document.getElementById('age').value = Math.floor(Math.random() * 40) + 20;
                if (Math.random() < 0.5) {
                    document.getElementById('gender-male').checked = true;
                } else {
                    document.getElementById('gender-female').checked = true;
                }
                document.getElementById('position-level').value = 'Staff';
                document.getElementById('job').value = 'Pemasaran';
                document.getElementById('industry').value = 'Teknologi';

                answers = {};
                questions.forEach(q => {
                    if (q.type === 'A') {
                        answers[q.id] = String(Math.floor(Math.random() * 6) + 1);
                    } else { 
                        answers[q.id] = Math.random() < 0.5 ? 'I' : 'D';
                    }
                });
            }


            // =================================================================================
            // Inisialisasi & Event Listeners
            // =================================================================================
            userInfoForm.addEventListener('submit', startQuestionnaire);
            prototypeBtn.addEventListener('click', runPrototypeMode);

            prevBtn.addEventListener('click', () => {
                if (currentQuestionPage > 0) {
                    currentQuestionPage--;
                    renderQuestions();
                    window.scrollTo(0,0);
                }
            });
            nextBtn.addEventListener('click', () => {
                if (currentQuestionPage < totalPages - 1) {
                    currentQuestionPage++;
                    renderQuestions();
                     window.scrollTo(0,0);
                }
            });
            finishBtn.addEventListener('click', submitAndShowResults);
            restartBtn.addEventListener('click', restartTest);
        });
    </script>
</body>
</html>

